---
layout: default
title: Setting Context - The Actor
---

# Setting Context ("the Actor")
Every API response must only include data that the authenticated user is authorized to view. Even when an API call is being made on the behalf of a different user, at no time should the API ever return data that the authenticated user is not authorized to see.

The one on whose behalf the API call is being made is considered the context for the API call. In the most simple case, this context is the authenticated user. However, sometimes it is desirable to change the user context (or limit the data returned) for one of two reasons:

* **Acting upon behalf of someone else.** One common example of this involves the use of a service account to authenticate for all API calls. The service account may be used, but the API call is really being placed for the benefit of a particular end user. Therefore, this end user is the real context. For example, a call to obtain a device catalog returns the list of devices that the end user is authorized to see, not the list that the service account may access (which might be all devices). [Request headers]({{site.url}}concepts/headers/) are used for this purpose.

* **Showing a subset of data that is relevant to a specific user in your hierarchy.** For example, a manager might want a list of devices assigned to a specific employee within the department that he/she manages. In this case, we need to utilize a filter to obtain a subset of the total devices that would have been returned without the filter. Query parameters are used for this purpose.

<br/>

## Employee ID vs. Company Employee ID

Before we can properly understand the difference between context and filtering, it is important to first know the difference between employee IDs and company Employee IDs. 

An employee ID is a GUID that is used to identify a specific employee and is generated by the Tangoe backend system (e.g., Command). The company employee ID identifies this same employee but instead is generated outside of the Tangoe backend system and can come in a variety of formats (e.g., number, email address, name, etc.). Although it is expected to be unique, Tangoe cannot guarantee its uniqueness since it is supplied by the customer. Therefore, the employee ID is always considered more reliable.

Whenever one of these identifiers is passed, either via headers or query parameters, it is important to know that the backend system will always look for the employee ID first. If one is not found, then the backend system will look to see if a company employee ID was passed and set the context to that. If neither was passed, then the backend system will set the context to the authenticated user. 

<br/>

## Context

The default context of every API call is assumed to be the logged in user. Therefore, the API calls will only return data that this authenticated user has been authorized to access. Often this the behavior that the user intended. 

However, sometimes an API user may wish to execute a call on behalf of someone else. For example, an administrator might need to locate the device asset record in order to deactivate a phone that an employee has lost. In such case, the context of the API call is not the logged in user, but rather someone else whose data the administrator is authorized to access.

Changing the context is accomplished via adding a header to the request that is set to either a Tangoe-generated ID (i.e., employee ID) or a third-party-generated ID (i.e., company employee ID). Specifically, these two headers are:

* [X-TNGO-CONTEXT-EMPLOYEEID]({{site.url}}concepts/headers/)
* [X-TNGO-CONTEXT-COMPANYEMPLOYEEID]({{site.url}}concepts/headers/)

The API resources that might require changing the context include:

* /catalog/devices
* /catalog/plans
* /catalog/accessories
* /regions
* /orders (HTTP POST method only)

<br/>

## /me

Sometimes it is helpful to retrieve additional details beyond the ID to identify the user to whom the context is set. The /me endpoint returns these details about the API caller and what they are able to procure. This information includes the identity of the authenticated user (i.e., logged in user), as well as the identity of the user on whose behalf the API is being called (commonly known as the “actor”). If the authenticated user is not a service account, these two users will often be the same person. In addition, the response also includes a list of the order transaction types that the actor. 

<br/>

## Filters

Often setting the default context to the current end user makes sense since they are one using the API to place an order on their own behalf or view information about assets assigned to themselves.  However, sometimes the user does not want to see every data record that he/she is authorized to see. For example,a manager may wish to only see the devices that his/her employee may order. This case calls for use of the employee filter.

The employee filter is set via one of two query parameters: 

* employee
* companyEmployeeId

The API resources that support the employee filter include:

* /assets/devices
* /assets/services
* /orders (HTTP GET method)
* /employees

